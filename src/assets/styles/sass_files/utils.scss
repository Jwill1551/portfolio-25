// --- Settings ---
$gutter: 8px; // base unit
$util-size: 30;   // 0 to 6 = 7 values total

// --- Breakpoints matching Bulma ---
$breakpoints: (
  sm: 0,          // mobile
  md: 769px,      // tablet
  lg: 1024px,     // desktop
  xl: 1216px,     // widescreen
  xxl: 1408px     // fullhd
);

// --- Helper: Get next breakpoint's min-width ---
@function next-breakpoint($breakpoint) {
  $keys: map-keys($breakpoints);
  $found: false;

  @each $key in $keys {
    @if $found {
      @return map-get($breakpoints, $key);
    }
    @if $key == $breakpoint {
      $found: true;
    }
  }

  @return null; // if no next breakpoint (e.g., xxl)
}

// --- Core generator ---
@mixin generate-spacing($prefix, $property, $max: $util-size) {
  @for $i from 0 through $max {
    $val: $i * $gutter;

    // No-breakpoint (base)
    .#{$prefix}-#{$i} { #{$property}: $val !important; }

    .#{$prefix}t-#{$i} { #{$property}-top: $val !important; }
    .#{$prefix}b-#{$i} { #{$property}-bottom: $val !important; }
    .#{$prefix}l-#{$i} { #{$property}-left: $val !important; }
    .#{$prefix}r-#{$i} { #{$property}-right: $val !important; }

    .#{$prefix}x-#{$i} {
      #{$property}-left: $val !important;
      #{$property}-right: $val !important;
    }
    .#{$prefix}y-#{$i} {
      #{$property}-top: $val !important;
      #{$property}-bottom: $val !important;
    }

    // Responsive classes
    @each $breakpoint, $min in $breakpoints {
      $max: next-breakpoint($breakpoint);

      @if $max != null {
        @media (min-width: $min) and (max-width: $max - 0.02px) {
          .#{$prefix}-#{$breakpoint}-#{$i} { #{$property}: $val !important; }

          .#{$prefix}t-#{$breakpoint}-#{$i} { #{$property}-top: $val !important; }
          .#{$prefix}b-#{$breakpoint}-#{$i} { #{$property}-bottom: $val !important; }
          .#{$prefix}l-#{$breakpoint}-#{$i} { #{$property}-left: $val !important; }
          .#{$prefix}r-#{$breakpoint}-#{$i} { #{$property}-right: $val !important; }

          .#{$prefix}x-#{$breakpoint}-#{$i} {
            #{$property}-left: $val !important;
            #{$property}-right: $val !important;
          }

          .#{$prefix}y-#{$breakpoint}-#{$i} {
            #{$property}-top: $val !important;
            #{$property}-bottom: $val !important;
          }
        }
      } @else {
        @media (min-width: $min) {
          .#{$prefix}-#{$breakpoint}-#{$i} { #{$property}: $val !important; }

          .#{$prefix}t-#{$breakpoint}-#{$i} { #{$property}-top: $val !important; }
          .#{$prefix}b-#{$breakpoint}-#{$i} { #{$property}-bottom: $val !important; }
          .#{$prefix}l-#{$breakpoint}-#{$i} { #{$property}-left: $val !important; }
          .#{$prefix}r-#{$breakpoint}-#{$i} { #{$property}-right: $val !important; }

          .#{$prefix}x-#{$breakpoint}-#{$i} {
            #{$property}-left: $val !important;
            #{$property}-right: $val !important;
          }

          .#{$prefix}y-#{$breakpoint}-#{$i} {
            #{$property}-top: $val !important;
            #{$property}-bottom: $val !important;
          }
        }
      }
    }
  }
}

/// Media query helper for Bulma breakpoints
/// Usage:
///   @include respond-to(tablet, up) { ... }
///   @include respond-to(tablet, down) { ... }
@mixin respond-to($breakpoint, $direction: up) {
  $value: map-get($breakpoints, $breakpoint);

  @if $value == null {
    @warn "Unknown breakpoint: #{$breakpoint}";
  } @else if $direction == up {
    @media (min-width: $value) {
      @content;
    }
  } @else if $direction == down {
    $next: next-breakpoint($breakpoint);

    @if $next {
      @media (max-width: ($next - 1)) {
        @content;
      }
    } @else {
      // No upper limit (for fullhd and above)
      @warn "No higher breakpoint after #{$breakpoint} â€” using infinite range.";
      @media (max-width: 9999px) {
        @content;
      }
    }
  } @else {
    @warn "Invalid direction: #{$direction}. Use 'up' or 'down'.";
  }
}

